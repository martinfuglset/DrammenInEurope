@import "tailwindcss";

/* Dark mode: same palette, class-based toggle */
@custom-variant dark (&:where(.dark, .dark *));

/* PP Talisman from /public/fonts
   Note: keep a version query to force cache refresh after font file updates. */
@font-face {
  font-family: "PP Talisman";
  src: url("/fonts/PPTalisman-Bold.otf?v=20260210") format("opentype");
  font-weight: 100 900;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "PP Talisman";
  src: url("/fonts/PPTalisman-Bold-Italic.otf?v=20260210") format("opentype");
  font-weight: 100 900;
  font-style: italic;
  font-display: swap;
}

@theme {
  /* Deep Royal Blue */
  --color-royal: #1A256D;
  --color-royal-dark: #11184D;
  
  /* Off-white Beige (Masculine/Vintage Paper) */
  --color-paper: #EBEBEB;
  --color-paper-dark: #D6D3CC;
  --color-white: #FFFFFF;

  /* Fonts – Inter for readable content, PP Talisman for display styling */
  --font-sans: "Inter", ui-sans-serif, system-ui, sans-serif;
  --font-serif: "Inter", ui-sans-serif, system-ui, sans-serif;
  --font-display: "PP Talisman", sans-serif;
  --font-mono: "PP Talisman", sans-serif;

  /* Typography – tuned for PPTalisman (condensed display) */
  --letter-spacing-display: -0.02em;
  --letter-spacing-display-tight: -0.03em;
  --letter-spacing-label: 0.18em;
  --letter-spacing-label-wide: 0.25em;
  --letter-spacing-body: 0.01em;
  --letter-spacing-small: 0.02em;
  --letter-spacing-micro: 0.04em;
  --leading-display: 1.1;
  --leading-display-tight: 1;
  --leading-body: 1.5;
  --leading-relaxed: 1.65;
  --leading-tight: 1.35;
  --leading-small: 1.65;
}

@layer base {
  html {
    font-size: 16px;
    -webkit-text-size-adjust: 100%;
  }
  body {
    @apply bg-paper text-royal antialiased selection:bg-royal selection:text-white;
    font-family: "Inter", ui-sans-serif, system-ui, sans-serif;
    font-weight: 400;
    font-size: 1rem;
    line-height: var(--leading-body);
    letter-spacing: var(--letter-spacing-body);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  html.dark body {
    @apply bg-royal-dark text-paper selection:bg-paper selection:text-royal-dark;
  }
  h1, h2, h3, h4, h5, h6 {
    @apply font-display font-bold uppercase;
    letter-spacing: var(--letter-spacing-display);
    line-height: var(--leading-display);
  }
  h1 { font-size: clamp(1.75rem, 5vw, 3rem); line-height: var(--leading-display-tight); letter-spacing: var(--letter-spacing-display-tight); }
  h2 { font-size: clamp(1.375rem, 3vw, 1.75rem); }
  h3 { font-size: clamp(1.125rem, 2vw, 1.35rem); }
}

/* Semantic type utilities – use these for consistent tracking/leading/size */
.type-display-1 {
  @apply font-display font-bold uppercase;
  font-size: clamp(1.875rem, 6vw, 4rem);
  line-height: var(--leading-display-tight);
  letter-spacing: var(--letter-spacing-display-tight);
}
.type-display-2 {
  @apply font-display font-bold uppercase;
  font-size: clamp(1.5rem, 4vw, 3rem);
  line-height: var(--leading-display);
  letter-spacing: var(--letter-spacing-display);
}
.type-label {
  font-size: 0.6875rem; /* 11px */
  letter-spacing: var(--letter-spacing-label);
  line-height: var(--leading-small);
  @apply font-display font-bold uppercase;
}
.type-label-wide {
  font-size: 0.625rem; /* 10px */
  letter-spacing: var(--letter-spacing-label-wide);
  line-height: var(--leading-small);
  @apply font-display uppercase;
}
.card-heading {
  @apply font-display font-bold uppercase text-royal;
  font-size: 1.125rem;
  line-height: 1.1;
  letter-spacing: var(--letter-spacing-display-tight);
}
/* Improved readability for small/body text – more spacing, no size change */
.text-readable {
  letter-spacing: var(--letter-spacing-small);
  line-height: var(--leading-small);
  -webkit-font-smoothing: antialiased;
}
.text-readable-micro {
  letter-spacing: var(--letter-spacing-micro);
  line-height: var(--leading-small);
  -webkit-font-smoothing: antialiased;
}
.type-body {
  font-size: 0.9375rem; /* 15px */
  line-height: var(--leading-body);
  letter-spacing: var(--letter-spacing-body);
}
.type-body-sm {
  font-size: 0.8125rem; /* 13px */
  line-height: var(--leading-body);
  letter-spacing: var(--letter-spacing-body);
}
/* Admin content: Inter for body text (notes, participants, etc.) – keep PP Talisman for titles/buttons/widgets */
.font-content {
  font-family: "Inter", ui-sans-serif, system-ui, sans-serif;
  font-weight: 400;
}
.type-long {
  line-height: var(--leading-relaxed);
}

/* Mobile / touch */
@layer utilities {
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }
  /* Bottom padding that respects safe-area (e.g. home indicator) */
  .pb-safe {
    padding-bottom: calc(6rem + env(safe-area-inset-bottom, 0px));
  }
  @media (min-width: 640px) {
    .pb-safe {
      padding-bottom: calc(8rem + env(safe-area-inset-bottom, 0px));
    }
  }
}

/* Participant names should remain easy to read in dense lists. */
.participant-name {
  font-family: "Inter", ui-sans-serif, system-ui, sans-serif !important;
  font-weight: 500 !important;
}

/* Utilities */
.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.no-scrollbar::-webkit-scrollbar {
  display: none;
}
.text-stroke {
  -webkit-text-stroke: 1px currentColor;
  color: transparent;
}

/* Form/readable text defaults */
input,
textarea,
select {
  @apply bg-transparent border-b border-royal/20 transition-all duration-300;
  font-family: "Inter", ui-sans-serif, system-ui, sans-serif;
  font-weight: 400;
  font-size: 0.9375rem;
  line-height: var(--leading-body);
  letter-spacing: var(--letter-spacing-body);
}
input:focus,
textarea:focus,
select:focus {
  @apply outline-none border-royal border-b-2;
}

/* Any long-form text blocks using display utility should still be readable. */
p.font-display,
li.font-display,
td.font-display,
th.font-display,
label.font-display {
  font-family: "Inter", ui-sans-serif, system-ui, sans-serif;
}
.no-underline-input {
  @apply border-b-0;
}
.no-underline-input:focus {
  @apply border-b-0;
}
.no-date-icon::-webkit-calendar-picker-indicator {
  display: none;
}
.no-date-icon::-webkit-inner-spin-button {
  display: none;
}
.no-date-icon {
  appearance: textfield;
}

/* Animations */
@keyframes countdown-pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.95; transform: scale(1.02); }
}
.animate-countdown-pulse {
  animation: countdown-pulse 1s ease-in-out infinite;
}
@keyframes spin-slow {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
.animate-spin-slow {
  animation: spin-slow 20s linear infinite;
}

/* Page and content fade */
@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes fade-in-up {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-page-in {
  animation: fade-in 0.4s ease-out forwards;
}
.animate-fade-in {
  animation: fade-in 0.35s ease-out forwards;
}
.animate-fade-in-up {
  animation: fade-in-up 0.4s ease-out forwards;
}

/* Stagger children (use on parent: animation-delay on children) */
.animate-stagger > * {
  animation: fade-in-up 0.4s ease-out forwards;
}
.animate-stagger > *:nth-child(1) { animation-delay: 0.03s; }
.animate-stagger > *:nth-child(2) { animation-delay: 0.06s; }
.animate-stagger > *:nth-child(3) { animation-delay: 0.09s; }
.animate-stagger > *:nth-child(4) { animation-delay: 0.12s; }
.animate-stagger > *:nth-child(5) { animation-delay: 0.15s; }
.animate-stagger > *:nth-child(6) { animation-delay: 0.18s; }
.animate-stagger > *:nth-child(7) { animation-delay: 0.21s; }
.animate-stagger > *:nth-child(8) { animation-delay: 0.24s; }
.animate-stagger > *:nth-child(9) { animation-delay: 0.27s; }
.animate-stagger > *:nth-child(10) { animation-delay: 0.3s; }
/* Dark mode – exact opposite of light: royal ↔ paper/white swapped, same opacities */
.dark { color-scheme: dark; }

/* Backgrounds: paper (page) → royal-dark; white (cards) → royal */
.dark .min-h-screen.bg-paper,
.dark .bg-paper { background-color: var(--color-royal-dark); }
.dark .bg-white { background-color: var(--color-royal); }
.dark .bg-white\/40 { background-color: rgb(26 37 109 / 0.4); }
.dark .bg-white\/60 { background-color: rgb(26 37 109 / 0.6); }
.dark .bg-white\/70 { background-color: rgb(26 37 109 / 0.7); }
.dark .bg-white\/80 { background-color: rgb(26 37 109 / 0.8); }

/* Text: royal → paper; white → paper (hero white → royal via rule below) */
.dark .text-royal,
.dark .text-royal\.font-semibold,
.dark .font-semibold.text-royal { color: var(--color-paper); }
.dark .text-white { color: var(--color-paper); }
.dark .text-white\/70 { color: rgb(234 232 227 / 0.7); }
.dark .text-white\/80 { color: rgb(234 232 227 / 0.8); }
.dark .text-white\/90 { color: rgb(234 232 227 / 0.9); }
.dark .text-royal\/40 { color: rgb(234 232 227 / 0.4); }
.dark .text-royal\/50 { color: rgb(234 232 227 / 0.5); }
.dark .text-royal\/60 { color: rgb(234 232 227 / 0.6); }
.dark .text-royal\/70 { color: rgb(234 232 227 / 0.7); }
.dark .text-royal\/80 { color: rgb(234 232 227 / 0.8); }

/* Borders: royal/X → paper/X (same opacity scale) */
.dark .border-royal\/10 { border-color: rgb(234 232 227 / 0.1); }
.dark .border-royal\/20 { border-color: rgb(234 232 227 / 0.2); }
.dark .border-royal\/30 { border-color: rgb(234 232 227 / 0.3); }
.dark .border-royal\/40 { border-color: rgb(234 232 227 / 0.4); }
.dark .border-royal { border-color: var(--color-paper); }
.dark .border-royal-dark,
.dark .border-2.border-royal-dark { border-color: rgb(234 232 227 / 0.25); }
.dark .border-paper { border-color: var(--color-royal); }
.dark .ring-royal\/20 { --tw-ring-color: rgb(234 232 227 / 0.2); }
.dark .ring-royal\/40 { --tw-ring-color: rgb(234 232 227 / 0.4); }
.dark .group-hover\:ring-royal\/40:hover { --tw-ring-color: rgb(234 232 227 / 0.4); }

/* Surfaces: bg-royal/X (light mode subtle blue) → paper/X (dark mode subtle paper) */
.dark .bg-royal\/5,
.dark .bg-royal\/\[0\.02\] { background-color: rgb(234 232 227 / 0.05); }
.dark .bg-royal\/10,
.dark .bg-royal\/15 { background-color: rgb(234 232 227 / 0.1); }
.dark .bg-royal\/20 { background-color: rgb(234 232 227 / 0.2); }
.dark .bg-royal\/25 { background-color: rgb(234 232 227 / 0.25); }
.dark .bg-royal\/30 { background-color: rgb(234 232 227 / 0.3); }

/* Buttons/accents: bg-royal (solid) → paper; bg-royal-dark → paper-dark */
.dark .bg-royal:not([data-keep-royal]) { background-color: var(--color-paper); color: var(--color-royal-dark); }
.dark .bg-royal-dark:not([data-keep-royal]) { background-color: var(--color-paper-dark); color: var(--color-royal-dark); }

/* Hover/focus: same logic, opposite color */
.dark .hover\:text-royal:hover { color: var(--color-paper); }
.dark .hover\:border-royal:hover { border-color: var(--color-paper); }
.dark .hover\:bg-royal\/25:hover { background-color: rgb(234 232 227 / 0.25); }
.dark .focus\:border-royal:focus,
.dark input:focus,
.dark textarea:focus { border-color: var(--color-paper); }
.dark .focus\:ring-royal\/30:focus { --tw-ring-color: rgb(234 232 227 / 0.3); }
.dark .focus\:ring-2.focus\:ring-royal\/40:focus { --tw-ring-color: rgb(234 232 227 / 0.4); }

/* Inputs */
.dark input,
.dark textarea { border-color: rgb(234 232 227 / 0.2); }
.dark .placeholder\:text-royal\/40::placeholder { color: rgb(234 232 227 / 0.4); }
.dark .accent-royal { accent-color: var(--color-paper); }
.dark .focus\:ring-1.focus\:ring-royal\/30:focus { --tw-ring-color: rgb(234 232 227 / 0.3); }
/* Underline decoration: opposite */
.dark .decoration-royal\/30 { text-decoration-color: rgb(234 232 227 / 0.3); }
.dark .decoration-royal { text-decoration-color: var(--color-paper); }
.dark .hover\:decoration-royal:hover { text-decoration-color: var(--color-paper); }
.dark .line-through.decoration-royal\/40 { text-decoration-color: rgb(234 232 227 / 0.4); }

/* Flat mode: gradients are intentionally disabled */

/* Dividers */
.dark .divide-royal\/5 > * { border-color: rgb(234 232 227 / 0.05); }
.dark .divide-royal\/10 > * { border-color: rgb(234 232 227 / 0.1); }

/* Alerts/semantic (amber, red, green): use paper as the “light” in dark mode */
.dark .bg-amber-50,
.dark .bg-amber-100 { background-color: rgb(17 24 77 / 0.5); }
.dark .border-amber-200,
.dark .border-amber-300 { border-color: rgb(234 232 227 / 0.25); }
.dark .text-amber-700,
.dark .text-amber-800 { color: var(--color-paper); }
.dark .text-red-300,
.dark .text-red-500,
.dark .hover\:text-red-500:hover { color: var(--color-paper); }
.dark .bg-red-500,
.dark .bg-green-500 { background-color: var(--color-paper); color: var(--color-royal-dark); }
.dark .text-green-600 { color: var(--color-paper); }

/* Flat mode: shadows are intentionally disabled */

/* Selection */
.dark .selection\:bg-royal *::selection,
.dark .selection\:bg-royal::selection { background-color: var(--color-paper); color: var(--color-royal-dark); }
.dark .selection\:text-white *::selection,
.dark .selection\:text-white::selection { color: var(--color-royal-dark); }

/* Flat mode overrides: remove remaining gradient/shadow utility effects globally */
[class*="bg-linear-to-"],
[class*="bg-gradient-to-"] {
  background-image: none !important;
}
[class*="shadow"],
[class*="drop-shadow"] {
  box-shadow: none !important;
  filter: none !important;
}

/* TipTap WYSIWYG editor */
.tiptap {
  font-family: "Inter", ui-sans-serif, system-ui, sans-serif;
  font-weight: 400;
  font-size: 0.875rem;
  line-height: 1.6;
  color: rgb(26 37 109 / 0.85);
  outline: none;
  padding: 0.75rem;
  min-height: 120px;
}
.tiptap-readonly {
  padding: 0;
  min-height: 0;
}
.tiptap h2 {
  font-family: "PP Talisman", sans-serif;
  font-weight: 700;
  text-transform: uppercase;
  color: var(--color-royal);
  font-size: 1rem;
  margin-top: 1rem;
  margin-bottom: 0.5rem;
}
.tiptap h2:first-child { margin-top: 0; }
.tiptap h3 {
  font-family: "PP Talisman", sans-serif;
  font-weight: 700;
  text-transform: uppercase;
  color: var(--color-royal);
  font-size: 0.875rem;
  margin-top: 0.75rem;
  margin-bottom: 0.25rem;
}
.tiptap p {
  margin: 0.375rem 0;
}
.tiptap p:first-child { margin-top: 0; }
.tiptap strong {
  font-weight: 600;
  color: var(--color-royal);
}
.tiptap em {
  font-style: italic;
}
.tiptap ul {
  list-style-type: disc;
  list-style-position: outside;
  padding-left: 1.5em;
  margin: 0.5em 0;
}
.tiptap ol {
  list-style-type: decimal;
  list-style-position: outside;
  padding-left: 1.5em;
  margin: 0.5em 0;
}
.tiptap li {
  margin: 0.25em 0;
}
.tiptap li p {
  margin: 0;
}
.tiptap table {
  border-collapse: collapse;
  width: 100%;
  margin: 0.75rem 0;
  font-size: 0.875rem;
}
.tiptap th {
  background-color: rgb(26 37 109 / 0.1);
  border: 1px solid rgb(26 37 109 / 0.2);
  padding: 0.5rem 0.75rem;
  text-align: left;
  font-weight: 600;
  color: var(--color-royal);
}
.tiptap td {
  border: 1px solid rgb(26 37 109 / 0.2);
  padding: 0.5rem 0.75rem;
}
.tiptap tr {
  border-bottom: 1px solid rgb(26 37 109 / 0.1);
}
.tiptap .selectedCell {
  background-color: rgb(26 37 109 / 0.08);
}
.tiptap blockquote {
  border-left: 3px solid rgb(26 37 109 / 0.2);
  padding-left: 1em;
  margin: 0.5em 0;
  color: rgb(26 37 109 / 0.6);
}
.tiptap hr {
  border: none;
  border-top: 1px solid rgb(26 37 109 / 0.15);
  margin: 1rem 0;
}
.tiptap p.is-editor-empty:first-child::before {
  content: attr(data-placeholder);
  float: left;
  color: rgb(26 37 109 / 0.35);
  pointer-events: none;
  height: 0;
  font-style: italic;
}

/* Map popup – match site style (royal/paper) */
.map-royal-style .leaflet-popup-content-wrapper {
  border: 1px solid rgb(26 37 109 / 0.2);
  font-family: "Inter", ui-sans-serif, system-ui, sans-serif;
}
.map-royal-style .leaflet-popup-content-wrapper .map-popup-inner {
  color: var(--color-royal);
}
.map-royal-style .leaflet-popup-tip {
  background: white;
}
html.dark .map-royal-style .leaflet-popup-content-wrapper {
  background: var(--color-royal);
  border-color: rgb(234 232 227 / 0.2);
}
html.dark .map-royal-style .leaflet-popup-content-wrapper .map-popup-inner,
html.dark .map-royal-style .leaflet-popup-content-wrapper .map-popup-inner p {
  color: var(--color-paper);
}
html.dark .map-royal-style .leaflet-popup-tip {
  background: var(--color-royal);
}

/* Map tiles – subtle styling */
.map-royal-style.leaflet-container {
  font-family: "Inter", ui-sans-serif, system-ui, sans-serif;
}
